(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return p});var s=n(1),o=n(3),i=n(2),r=n.n(i),a=n(9),c=n(4),u=n(6);let l=null;const d=new s.b("Dialog"),f=new o.Storage("dialog-messaging",o.StorageType.SessionStorage),h=Object(a.a)(["dialogClosed","dialogLoaded","dialogResult","failed"]);class p{constructor(e,t=30,n=20){this._url=Object(u.a)(e),this._height=t,this._width=n}static addMessageListner(e){p.removeMessageListner(),l=e,window.addEventListener("storage",async t=>{if("function"==typeof e){const n=t.key,s=t.newValue;if(n===f._scope("message")&&s){const n=JSON.parse(JSON.parse(t.newValue));await Promise.resolve(e(n)),f.delete("message")}}})}static hideOverlay(e){r()(e).off("click.showOverlay");const t=r()(".ms-Overlay");new c.a.Overlay(t[0]).hide()}static removeMessageListner(){l&&(window.removeEventListener("storage",l),l=null)}static sendMessage(e,t=null){Office.context.ui.messageParent(JSON.stringify({data:t,type:e}))}static async showNotificationAsync(e,t,n,o=20,i=16){if(t=void 0!==t&&s.a[t]?t:s.a.info,d[s.a[t]](e),t!==s.a.debug){const r="string"==typeof e?e:e.message,a=`~/notification-dialog.html?message=${encodeURIComponent(r.replace("\n","Â¦"))}&title=${encodeURIComponent(n||"")}&type=${s.a[t]}`;return await new p(a,o,i).showModalAsync()}}static showOverlay(e){const t=r()(e);t.off("click.showOverlay").on("click.showOverlay",s);const n=r()(".ms-Overlay").css("z-index",9999).off("click.showOverlay").on("click.showOverlay",s);function s(e){return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),p.showOverlay(t),!1}new c.a.Overlay(n[0]).show()}showModalAsync(e,t=null){return new Promise(n=>{Office.context.ui.displayDialogAsync(this._url,{asyncContext:t,displayInIframe:!0,height:this._height,width:this._width},s=>{if(s.status===Office.AsyncResultStatus.Failed)return void n({context:t,data:s.error,type:h.failed});const o=s.value;o.addEventHandler(Office.EventType.DialogEventReceived,()=>{this._dialogCloseAsync(o,()=>n({context:t,data:null,dialog:o,type:h.dialogClosed}))}),o.addEventHandler(Office.EventType.DialogMessageReceived,async s=>{const i=this._parseMessage(s);i.context=t,i.dialog=o;let r=!0;"function"==typeof e&&(r=await Promise.resolve(e(i,this))),r&&this._dialogCloseAsync(o,()=>n(i))})})})}sendMessage(e,t=null){f.set("message",JSON.stringify({data:t,type:e}))}_dialogCloseAsync(e,t){e.close(),setTimeout(()=>{try{e.addEventHandler(Office.EventType.DialogMessageReceived,()=>{}),this._dialogCloseAsync(e,t)}catch(e){t()}},0)}_parseMessage(e){return"string"==typeof e.message?JSON.parse(e.message):{data:e.message,type:h.dialogResult}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c});var s=n(8),o=n(9),i=n(3);const r=Object(o.a)(["none","error","warn","info","debug"]),a=s.a?r.debug:r.warn;class c{get id(){return this._id}get isDebugEnabled(){return this._level===r.debug}get level(){return this._level}set level(e){this._level=e}constructor(e,t){this._id=e,this._level=Number.isInteger(t)&&t>=0?t:a}debug(e,...t){this._log(r.debug,e,...t)}error(e,...t){this._log(r.error,e,...t)}info(e,...t){this._log(r.info,e,...t)}warn(e,...t){this._log(r.warn,e,...t)}_log(e,t,...n){if(e<=this.level){const s=r[e];t=`${s.toUpperCase()} [${this.id}] ${t}`,e===r.error?i.Utilities.log(t,...n):console[s](t,...n)}}}},,,,function(e,t,n){"use strict";n.d(t,"a",function(){return f});var s=n(2),o=n.n(s),i=n(19),r=n(9),a=n(1);const c=Object(r.a)(["DELETE","GET","OPTIONS","PATCH","POST","PUT"]),u=(Object(r.a)({OK:200,Created:201,NoContent:204,BadRequest:400,Forbidden:403,NotFound:404,MethodNotAllowed:405}),"http://localhost"),l={accessToken:"",accessTokenExpiresIn:0,apiUrl:"/api",password:"",username:"",windowsAuth:!1},d=new a.b("Web API");class f{constructor(e=u,t={}){this._serverUrl=new URL(new URL(e||u).origin),this._options=Object.assign({},l,t),this._options.accessTokenExpiresAt=this._options.accessTokenExpiresAt||p(this._options.accessTokenExpiresIn),this._options.apiUrl=this._url(this._options.apiUrl)}get apiUrl(){return this._options.apiUrl}get serverUrl(){return this._serverUrl}deleteAsync(e,t,n){return this._fetchAsync(c.DELETE,e,void 0,t,n)}getAsync(e,t,n){return this._fetchAsync(c.GET,e,void 0,t,n)}patchAsync(e,t,n,s){return this._fetchAsync(c.PATCH,e,t,n,s)}postAsync(e,t,n,s){return this._fetchAsync(c.POST,e,t,n,s)}postFileAsync(e,t,n){const s=new FormData;return s.append(t,n,t),Promise.resolve(o.a.ajax({beforeSend:e=>void this._setAuthorization(e,!1),contentType:!1,data:s,method:"POST",processData:!1,url:this._url(e).toString()}).then(e=>e,e=>{const t=new Error(`${e.status} ${h(e.status)}`);throw t.data=e.responseJSON,t}))}putAsync(e,t,n,s){return this._fetchAsync(c.PUT,e,t,n,s)}_accessToken(){const e=p();return this._options.accessToken&&this._options.accessTokenExpiresAt<=e&&(d.warn("Access token expired."),this._options.accessToken=""),this._options.accessToken}async _fetchAsync(e,t,n,s,i){const r=e===c.POST||e===c.PUT||e===c.PATCH;return Promise.resolve(o.a.ajax({beforeSend:e=>void this._setAuthorization(e,i),contentType:r?"application/json":void 0,data:r?JSON.stringify(n):void 0,method:c[e],url:this._url(t).toString()}).then((e,t,n)=>(function(e,t){if("object"==typeof t&&null!==t)for(const n of Object.keys(t))t[n]=e.getResponseHeader(n)}(n,s),e),e=>{const t=new Error(`${e.status} ${h(e.status)}`);throw t.data=e.responseJSON,t}))}_setAuthorization(e,t){if(t)return!1;if(this._options.username&&this._options.password)return d.debug(`Basic Authentication: ${this._options.username}`),e.setRequestHeader("Authorization",`Basic ${i.Base64.encode(this._options.username+":"+this._options.password)}`),!0;const n=this._accessToken();return n?(d.debug(`Bearer Authentication: ${n}`),e.setRequestHeader("Authorization",`Bearer ${n}`),!0):(d.debug(`Windows Integrated Authentication: ${this._options.windowsAuth}`),this._options.windowsAuth)}_url(e){return new URL((""+e).replace("~/",`${this._options.apiUrl}/`).replace(/\/*$/,""),this._serverUrl)}}function h(e){switch(e){case 400:return"Bad Request";case 403:return"Forbidden";case 404:return"Not Found";case 405:return"Method Not Allowed";case 500:return"Internal Server Error";default:return"Unknown"}}function p(e){const t=new Date;return t.setSeconds(t.getSeconds()+(e|=0)),t}},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var s=n(2),o=n.n(s);function i(e){return o()("<div/>").text(e).html()}function r(e){if("~/"!==e.substr(0,2))return e;const t=new URL(window.location.href),n=t.pathname.split("/");return n.splice(-1,1),`${t.origin}${n.join("/")}/${e.substr(2)}`}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c});var s=n(3),o=n(20);const i=new s.Storage("DocumentPropertiesCache",s.StorageType.SessionStorage);async function r(){let e=i.get("properties");if(e&&e.OFF_CTX_Url)return e;var t;switch((e={}).OFF_CTX_ContentLanguage=Office.context.contentLanguage,e.OFF_CTX_DisplayLanguage=Office.context.displayLanguage,e.OFF_CTX_FileName=(t=Office.context.document.url,new URL(t).pathname.split("/").pop()),e.OFF_CTX_IsAddin=s.Utilities.isAddin,e.OFF_CTX_IsIEOrEdge=s.Utilities.isIEOrEdge,e.OFF_CTX_Host=Office.context.host,e.OFF_CTX_Mode=Office.context.document.mode,e.OFF_CTX_OfficeTheme=Office.context.officeTheme,e.OFF_CTX_Platform=Office.context.platform,e.OFF_CTX_TouchEnabled=Office.context.touchEnabled,e.OFF_CTX_Url=Office.context.document.url,e.OFF_CTX_Version=Office.context.diagnostics.version,Office.context.host){case Office.HostType.Excel:await async function(e){try{await Excel.run(async t=>{t.workbook.load("name");const n=t.workbook.properties.custom;n.load("key,type,value"),await t.sync();for(const t of n.items)e[t.key]=t.value})}catch(e){}}(e);break;case Office.HostType.Word:await async function(e){try{await Word.run(async t=>{const n=t.document.properties.customProperties;n.load("key,type,value"),await t.sync();for(const t of n.items)e[t.key]=t.value})}catch(e){}}(e);break;case Office.HostType.PowerPoint:await Promise.resolve()}return await async function(e){await new Promise(async t=>{let n="";try{const e=new o.a;n=await e.getFileContentAsync(`${Office.context.document.url}.props`)}catch(e){}if(n&&n.length&&"{"===n[0]){let t;try{t=JSON.parse(n)}catch(e){t=JSON.parse(function(e){let t="";for(let n=0;n<e.length;n+=2){const s=e.charCodeAt(n),o=e.charCodeAt(n+1);t+=String.fromCharCode((o<<16)+s)}return t}(n))}for(const n of Object.keys(t)){const s=t[n];null!==s&&(e[n]=s)}}t()})}(e),i.set("properties",e),e}async function a(){return(await r()).SGM_SYS_Server}async function c(){const e=await r();return e.SGM_SYS_Server&&+e.SGM_SYS_ProjectID>0}},function(e,t,n){"use strict";(function(e,s){n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"d",function(){return f});var o=n(10),i=n(17),r=n.n(i);const a=e,c=(r.a.join(a,"src"),r.a.join(a,"dist"),r.a.join(a,"media_skeleton"),r.a.join(a,"plugin_skeleton"),r.a.join(a,".tmp")),u=(s.env.APP_DESCRIPTION||o.b,s.env.APP_NAME,s.env.APP_COPYRIGHT||o.a,"a4f66b72-5dbc-4049-8c98-2cdc1bd83fb9"),l="1af3b98c-a2b1-470d-8e5e-14d2b6336f0a",d=(r.a.join(c,"app"),!1),f="31536000"}).call(this,"/",n(21))},function(e,t,n){"use strict";function s(e){const t={};if(Array.isArray(e)){let n=-1;for(const s of e)t[t[++n]=""+s]=n}else if("object"==typeof e||"function"==typeof e){let n=-1;for(const s of Object.keys(e)){const o=e[s];t[t[n=Number.isInteger(o)?o:n+1]=s]=n}}else t[t[""+e]=0]=0;return Object.freeze(t)}n.d(t,"a",function(){return s})}]]);